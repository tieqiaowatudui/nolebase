在工作和学习的时候,发现一些概念需要深入的了解一下,但是没有办法放下当前工作,进入新的任务.这个时候需要一个快速的将概念记录下来.后续对概念进行处理,处理完成后将将概念标记为完成.  
# 交互
整体交互过程分为:  
- 记录闪念
- 列出未完成的闪念
- 处理闪念
- 标记完成的闪念
- 列出完成的闪念
# 交互实现
使用mac电脑上的Alfred Workflow来帮助实现整个流程.使用hot-key + run script / script filter + notification 帮助串起整个流程.
![[Pasted image 20260111154240.png]]
其中 Script Filter + Run Script相同的地方,都是可以接受参数,并且执行脚本.在当前任务的区别中,Script Filter可以将执行完成后的结果以列表的形式输出,然后展示在Alfred 窗口中.提供选择.Script Filter提供了一个交互的场景.Run Script的功能主要是执行一个参数.更详细的查看[[Alfred 中 Run Script和Script Filter的区别]]
# 后端实现
## 数据存储
使用两个json文件,json文件结构是一个对象的列表.一个json文件存放为处理,另一个存放处理完成的.  
列表中的每一个元素表示一个概念,概念结构如下图:
```json
{
    "id": "20260111151530",
    "title": "结构化思维和系统化思维",
    "created_at": "2026-01-11 15:15:30",
    "status": "todo",
    "done_at": null
  }
```
其中status有三种状态分别为:
- todo :未处理
- processing:处理中
- done:处理完成
## 接口函数
- done.py    :标记任务完成.
- load_done.py:加载所有完成的概念
- processing.py:处理当前的概念
- capture.py	:捕捉当前的概念			  
- load.py     :加载所有未完成的概念
- router.py:在未完成的概念列表中,选中一个概念的时候,路由到 done 或者 processing中.

## 具体实现
### capture.py
```python
# capture.py
import json
import sys
from pathlib import Path
from datetime import datetime
from filelock import FileLock

DATA_FILE = Path.home() / "Documents/concepts.json"
LOCK_FILE = str(DATA_FILE) + ".lock"

def load_data():
    if DATA_FILE.exists():
        with open(DATA_FILE, "r", encoding="utf-8") as f:
            return json.load(f)
    return []

def save_data(data):
    with open(DATA_FILE, "w", encoding="utf-8") as f:
        json.dump(data, f, ensure_ascii=False, indent=2)

def main():
    title = sys.argv[1].strip()
    if not title:
        return

    now = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    concept_id = datetime.now().strftime("%Y%m%d%H%M%S")

    concept = {
        "id": concept_id,
        "title": title,
        "created_at": now,
        "status": "todo",
        "done_at": None
    }

    # 文件锁，保证并发安全
    lock = FileLock(LOCK_FILE)
    with lock:
        data = load_data()
        data.append(concept)
        save_data(data)

if __name__ == "__main__":
    main()

```

